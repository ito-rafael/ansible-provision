- name: users | rafael | create group
  tags: users,rafael,groups
  group:
    name: rafael
    state: present

- name: users | rafael | create user
  tags: users,rafael
  user:
    name: rafael
    group: rafael
    groups: "{{ sudo_group }}"
    append: true
    state: present
    createhome: true
    comment: "Rafael Ito"
    password: "{{ rafael_passwd }}"
    system: false
    shell: /usr/bin/zsh

- name: users | rafael | ensure home dir ownership
  tags: users,rafael
  file:
    path: /home/rafael
    owner: rafael
    group: rafael
    mode: 0700
    recurse: yes
    state: directory

- name: users | rafael | add sudoers file
  tags: users,rafael,sudo
  copy:
    src: files/users/sudoers_rafael
    dest: /etc/sudoers.d/rafael
    owner: root
    group: root
    mode: 0440
    validate: "/usr/bin/visudo -cf %s"
