- name: users | dotfiles | ensures dirs exists
  tags: users,dotfiles,clone
  file:
    path: "{{ item }}"
    state: directory
    owner: rafael
    group: rafael
    mode: 0700
  with_items:
    - "/home/rafael/git"
    - "/home/rafael/.config"

- name: users | dotfiles | clone dotfiles repo
  tags: users,dotfiles,clone
  #become: yes
  #become_user: rafael
  git:
    clone: yes
    repo: "{{ item.repo }}"
    dest: "{{ item.dest }}"
  with_items:
    - { repo: "https://github.com/ito-rafael/dotfiles.git", dest: "/home/rafael/git/dotfiles" }
    - { repo: "https://github.com/ito-rafael/keebab.git",   dest: "/home/rafael/git/keebab" }

- name: users | dotfiles | change ownership of dotfiles repo
  tags: users,dotfiles,clone
  file:
    path: /home/rafael/git/{{ item }}
    state: directory
    recurse: yes
    owner: rafael
    group: rafael
  with_items:
    - dotfiles
    - keebab
